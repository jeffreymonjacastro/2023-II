format long
k_gm = 0.026
a = 1950
b = 2000
pmax = 12000
p0 = 1950
h = 1

syms t p
f = @(t,p)( k_gm*(1-p/pmax)*p)

[z] = RKF(f,a,b,p0,h)


p60 = z(11,2)
p70 = z(21,2)
p00 = z(51,2)

function [z] = RKF(f,a,b,y0,h)
    n = (b-a)/h;
    t = (a:h:b)';
    z = [];
    for i = 1:(n+1)
        k1 = f(t(i),y0);
        k2 = f(t(i)+ h/5 , y0 + k1*(h/5));
        k3 = f(t(i) + (3*h)/10 , y0 + (3*h*k1)/40 + (9*k2*h)/40  );
        k4 = f(t(i) + (3*h)/5 , y0 + (3*h*k1)/10 - (9*k2*h)/10 + (6*k3*h)/5 );
        k5 = f(t(i) + h ,  y0 - (11*k1*h)/54 + (5*k2*h)/2 - (70*k3*h)/27 + (35*k4*h)/27 );
        k6 = f(t(i) + 7*h/8 , y0 + (1631*k1*h)/55296 + (175*k2*h)/512 + (575*k3*h)/13824 + (44275*k4*h)/110592 + (253*k5*h)/4096);
        y1 = y0 + (2825*k1/27648 + 18575*k3/43384 + 13525*k4/55296 + 277*k5/14336 + 1*k6/4)*h;
        z = [z;t(i) y0 k1 k2 k3 k4 y1];
        y0 = y1;    
    end
end